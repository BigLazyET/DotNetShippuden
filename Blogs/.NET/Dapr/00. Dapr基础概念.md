# Dapr基础概念

> Dapr支持任何语言，任何框架，支持部署任何地方
> 
> Dapr提供云平台和边缘计算的微服务构建块的最佳实现，可以使用标准模式进行微服务应用的构建，并部署到任何环境中

## 一、构建块 - Building Blocks

> 构建块 是可以从您的代码中调用的HTTP或gRPC API，并且由一个或多个Dapr组件组成。

> 构建块解决了构建弹性微服务应用程序中的常见挑战，并编纂了最佳实践和模式。 Dapr由一组构建块组成，并且具有可扩展性以添加新的构建块。

### 1. 初步理解

* Dapr的构建块提供各自服务相关的公开的API，供App调用
* Dapr的构建块可以由多个Dapr Component组成

### 2. 进一步理解

* 从调用方角度，可以是跟Dapr Sidecar一起运行的我们的App
> 进一步思考：那我们是否也可以通过其他与Dapr Sidecar无关的应用(或者叫客户端，比如浏览器)，通过Http调用的方式直接访问Dapr构建块提供的API呢？
* 从调用方式考虑，如果直愣愣的在App中写代码通过http/grpc的方式调用构建块API可以但没必要；各个语言都有自己的Dapr sdk，里面已经封装了对各个构建块API的调用
* 为什么每个语言都能有自己的Dapr sdk，因为Dapr构建块对外提供了同一套标准和规则，可以说它提供了协议与标准，至于怎么接入和实现那就是各自语言的事情了

## 二、组件 - Components

> Dapr使用模块化设计，将功能作为组件来设计 => 组件提供功能，功能的分类或者说类型就是构建块的名称和用途

> 组件是被用于构建块和应用程序的模块化功能

### 1. 那么问题来了，构建块跟组件又是什么关系？
**可以理解构建块是个桥梁的角色**

* 构建块对外提供统一标准，规则，协议，从而让各个语言可以编写自身的dapr sdk，方便各个语言编写的服务引入sdk，从而调用构建块公开的功能
* 构建块对内提供统一的接口定义，从而让组件的实现有了标准，组件只要遵循这个接口的标准来实现即可；所以一种类型的构建块可以有N种组件的实现，一个组件也可以同时实现多个构建块的标准接口

### 2. 进一步理解

**以状态组件为例**

* 实现了一个状态组件，其数据存储用了redis；组件同时实现了Actors构建块和状态管理构建块的接口 => 那么【actors 构建块】和【状态管理构建块】都可以这个状态组件
* 状态组件的数据存储可以用redis，那我们是否可以用其他的数据库做它的存储呢？显然是可以的 => 这就导致了组件的多样性

以上说明了两点：
* 组件同时实现了多个构建块的标准接口的话，那么多个构建块可以用同一个组件
* 同一种构建块功能的组件的实现可以用多种方式，比如可观察性构建块的组件，可以用prometheus、jaeger、zipkin等去实现接收trace的功能
* 实现了同一构建块标准接口的组件之间可以相互更换，实现可插拔